<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>阶段工作总结 | skippy's life</title><meta name="author" content="skippy"><meta name="copyright" content="skippy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="人脸风格化可行性方案   目前路线为 多数据源启动数据，小样本训练 Lora 后，使用数据合成循环管道，不断过滤优化数据，生成大量数据，最终训练出高质量的指令引导的人脸风格化模型    一、现有开源工具生成1、通过 EasyControl 生成 Ghibli 风格的人脸数据https:&#x2F;&#x2F;github.com&#x2F;Xiaojiu-z&#x2F;EasyControl 2、通过 豆包 生成部分风格数据   还需注">
<meta property="og:type" content="article">
<meta property="og:title" content="阶段工作总结">
<meta property="og:url" content="http://example.com/2025/05/02/%E9%98%B6%E6%AE%B5%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="skippy&#39;s life">
<meta property="og:description" content="人脸风格化可行性方案   目前路线为 多数据源启动数据，小样本训练 Lora 后，使用数据合成循环管道，不断过滤优化数据，生成大量数据，最终训练出高质量的指令引导的人脸风格化模型    一、现有开源工具生成1、通过 EasyControl 生成 Ghibli 风格的人脸数据https:&#x2F;&#x2F;github.com&#x2F;Xiaojiu-z&#x2F;EasyControl 2、通过 豆包 生成部分风格数据   还需注">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/wangfei.jpg">
<meta property="article:published_time" content="2025-05-02T09:03:15.000Z">
<meta property="article:modified_time" content="2025-05-17T11:25:14.555Z">
<meta property="article:author" content="skippy">
<meta property="article:tag" content="AIGC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/wangfei.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "阶段工作总结",
  "url": "http://example.com/2025/05/02/%E9%98%B6%E6%AE%B5%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/",
  "image": "http://example.com/img/wangfei.jpg",
  "datePublished": "2025-05-02T09:03:15.000Z",
  "dateModified": "2025-05-17T11:25:14.555Z",
  "author": [
    {
      "@type": "Person",
      "name": "skippy",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/wangfei.jpg"><link rel="canonical" href="http://example.com/2025/05/02/%E9%98%B6%E6%AE%B5%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '阶段工作总结',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/aplayer.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/timego.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/wangfei.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-timeline"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/movies"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/aboutme/"><i class="fa-fw fas fa-user"></i><span> About me</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/timego.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">skippy's life</span></a><a class="nav-page-title" href="/"><span class="site-name">阶段工作总结</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-timeline"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/movies"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/aboutme/"><i class="fa-fw fas fa-user"></i><span> About me</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">阶段工作总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-02T09:03:15.000Z" title="发表于 2025-05-02 17:03:15">2025-05-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-17T11:25:14.555Z" title="更新于 2025-05-17 19:25:14">2025-05-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">974</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>3分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="人脸风格化可行性方案"><a href="#人脸风格化可行性方案" class="headerlink" title="人脸风格化可行性方案"></a>人脸风格化可行性方案</h1><blockquote>
<p>  目前路线为 多数据源启动数据，小样本训练 Lora 后，使用数据合成循环管道，不断过滤优化数据，生成大量数据，最终训练出高质量的指令引导的人脸风格化模型</p>
</blockquote>
<img src="/img/work/1.jpg"/>

<h2 id="一、现有开源工具生成"><a href="#一、现有开源工具生成" class="headerlink" title="一、现有开源工具生成"></a>一、现有开源工具生成</h2><h3 id="1、通过-EasyControl-生成-Ghibli-风格的人脸数据"><a href="#1、通过-EasyControl-生成-Ghibli-风格的人脸数据" class="headerlink" title="1、通过 EasyControl 生成 Ghibli 风格的人脸数据"></a>1、通过 EasyControl 生成 Ghibli 风格的人脸数据</h3><p><a target="_blank" rel="noopener" href="https://github.com/Xiaojiu-z/EasyControl">https://github.com/Xiaojiu-z/EasyControl</a></p>
<h3 id="2、通过-豆包-生成部分风格数据"><a href="#2、通过-豆包-生成部分风格数据" class="headerlink" title="2、通过 豆包 生成部分风格数据"></a>2、通过 豆包 生成部分风格数据</h3><blockquote>
<p>  还需注意是否开源、开源协议</p>
</blockquote>
<p>例如 <code>3D动漫、插画、绘本</code> … 均有不错的表现</p>
<h3 id="3、通过-HiDream-I1-生成数据"><a href="#3、通过-HiDream-I1-生成数据" class="headerlink" title="3、通过 HiDream-I1 生成数据"></a>3、通过 HiDream-I1 生成数据</h3><p><a target="_blank" rel="noopener" href="https://github.com/HiDream-ai/HiDream-I1">https://github.com/HiDream-ai/HiDream-I1</a></p>
<p>在线测试，风格化后均为半身照，这意味着只能专门处理半身人像</p>
<p>部署显存需 <code>70GB</code> 以上，待实验</p>
<h3 id="Step-1X"><a href="#Step-1X" class="headerlink" title="Step-1X"></a>Step-1X</h3><p><a target="_blank" rel="noopener" href="https://huggingface.co/stepfun-ai/Step1X-Edit">https://huggingface.co/stepfun-ai/Step1X-Edit</a></p>
<p>以 Ghibli 风格图像为 Bridge 可以得到较好的风格化效果，不过受 Ghibli 影响较大</p>
<h3 id="4、SD-3-5"><a href="#4、SD-3-5" class="headerlink" title="4、SD 3.5"></a>4、SD 3.5</h3><p><a target="_blank" rel="noopener" href="https://platform.stability.ai/">https://platform.stability.ai/</a></p>
<p>在以往实验中，SD 3.5 生成其预设的风格能力还是非常不错的，例如<code>pixel、cyberpunk</code>，不过模型还<strong>没有开源</strong></p>
<h2 id="二、Multi-Control-面部解偶-deStyle"><a href="#二、Multi-Control-面部解偶-deStyle" class="headerlink" title="二、Multi_Control 面部解偶 deStyle"></a>二、Multi_Control 面部解偶 deStyle</h2><blockquote>
<p>  数据生成步骤中的 <code>核心创新点 </code></p>
</blockquote>
<p>使用 FLUX+ControlNet 为base，通过分别提取人脸和背景 canny，同时设有不同的权重，通过 prompt 引导实现已风格化图像的去风格化任务。</p>
<p>基于现有实验拟定的<strong>最佳组合参数</strong>如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">control_image=[</span><br><span class="line">    control_image_pose,</span><br><span class="line">    control_image_canny, <span class="comment">#background</span></span><br><span class="line">    control_image_canny_face,</span><br><span class="line">    <span class="comment"># control_image_depth</span></span><br><span class="line">    ], </span><br><span class="line">controlnet_conditioning_scale=[<span class="number">0.33</span>,<span class="number">0.5</span>,<span class="number">0.3</span>],</span><br><span class="line">control_guidance_end=[<span class="number">0.3</span>,<span class="number">0.8</span>,<span class="number">0.65</span>],</span><br><span class="line">num_inference_steps=<span class="number">45</span>,</span><br><span class="line">guidance_scale=<span class="number">8</span>,</span><br></pre></td></tr></table></figure>

<h3 id="尝试过的部分失败组合"><a href="#尝试过的部分失败组合" class="headerlink" title="尝试过的部分失败组合"></a>尝试过的部分失败组合</h3><ul>
<li><p>Pose + Canny_backgroud , 缺少面部信息，模型生成面部内容质量很低</p>
</li>
<li><p>Canny_face + Canny_backgrond , 缺少 <code>Pose</code> 的引导与平衡，<code>Canny</code> 完全占主导地位，效果不佳</p>
</li>
<li><p>…+ Depth , 高权重下 <code>Depth</code> 的阴影部分严重影响生成图片的背景，使背景变暗，低权重几乎没有作用</p>
</li>
</ul>
<h3 id="当前组合下的几个疑难点"><a href="#当前组合下的几个疑难点" class="headerlink" title="当前组合下的几个疑难点"></a>当前组合下的几个疑难点</h3><ul>
<li><p>由于目前仅基于 FFHQ 数据集测试，均为人脸或小半身人脸，且于 <code>Canny</code> 控制下 <code>Pose</code> 作用甚微，主要起补充信息作用，后续若扩张为半身人像或全身人像，该参数可能需重新考虑</p>
</li>
<li><p>Double Canny 权重拮抗，若人脸 <code>canny</code> 权重高于背景，则可能会出现过拟合的状态，<code>eg：Ghibli 的大眼睛</code>，若背景 <code>canny</code> 权重高于人脸，则可能会出现丢失面部内容信息，所以这两个参数还需不断测试，或探索别的办法来解决这一问题</p>
</li>
<li><p>prompt 质量严重影响生成质量，这是最让我头疼的一点，同样参数下，不同的 <code>prompt</code> 产出的内容质量差别不小，个人认为 <code>prompt</code> 中应至少含有以下几点信息 <code>头发颜色，衣服颜色，背景颜色，肤色，真实感，真实皮肤纹理</code>等等</p>
</li>
<li><p>step、guidance_scale 的值同样值得推敲</p>
</li>
</ul>
<p>后续应批量处理数据，不断改进参数，找到适配这样去风格处理手段的风格，测试 Multi_control 和 Single_control的差异</p>
<h1 id="不同风格适宜参数"><a href="#不同风格适宜参数" class="headerlink" title="不同风格适宜参数"></a>不同风格适宜参数</h1><table>
<thead>
<tr>
<th>风格</th>
<th>pose</th>
<th>cy_BG</th>
<th>cy_noFace</th>
<th>step</th>
<th>guidance_scale</th>
</tr>
</thead>
<tbody><tr>
<td>3D风格</td>
<td>0.33</td>
<td>0.35</td>
<td>0.2</td>
<td>40</td>
<td>10</td>
</tr>
<tr>
<td>end</td>
<td>0.3</td>
<td>0.4</td>
<td>0.3</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>Ghibli</td>
<td>0.33</td>
<td>0.5</td>
<td>0.3</td>
<td>45</td>
<td>8</td>
</tr>
<tr>
<td>end</td>
<td>0.3</td>
<td>0.8</td>
<td>0.65</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>WaterColor</td>
<td>0.33</td>
<td>0.5</td>
<td>0.3</td>
<td>45</td>
<td>8</td>
</tr>
<tr>
<td>end</td>
<td>0.3</td>
<td>0.8</td>
<td>0.65</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>monet</td>
<td>0.33</td>
<td>0.3</td>
<td>0.25</td>
<td>40</td>
<td>10</td>
</tr>
<tr>
<td>end</td>
<td>0.3</td>
<td>0.7</td>
<td>0.55</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>sketch</td>
<td>0.33</td>
<td>0.5</td>
<td>0.5</td>
<td>40</td>
<td>10</td>
</tr>
<tr>
<td>end</td>
<td>0.3</td>
<td>0.7</td>
<td>0.55</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>Disney</td>
<td>0.33</td>
<td>0.4</td>
<td>0.25</td>
<td>40</td>
<td>10</td>
</tr>
<tr>
<td>end</td>
<td>0.3</td>
<td>0.7</td>
<td>0.35</td>
<td>-</td>
<td>-</td>
</tr>
</tbody></table>
<h2 id="pixel"><a href="#pixel" class="headerlink" title="pixel"></a>pixel</h2><p>可以使用 Ghibli 当 Bridge 通过 Step-1X StyleTransfer 得到 ，sd 3.5 可以很好的处理 pixel 风格</p>
<h2 id="3D"><a href="#3D" class="headerlink" title="3D"></a>3D</h2><p>遗留问题：太不稳定了 但是只需要 100 200 张的话可以用量堆出来 </p>
<h2 id="moent"><a href="#moent" class="headerlink" title="moent"></a>moent</h2><p>遗留问题：肤色、男生</p>
<h2 id="FLUX-能力有限"><a href="#FLUX-能力有限" class="headerlink" title="FLUX 能力有限"></a>FLUX 能力有限</h2><p>在我测试的 极简 美漫 星月夜 梵高 … 效果不佳</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">skippy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/05/02/%E9%98%B6%E6%AE%B5%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/">http://example.com/2025/05/02/%E9%98%B6%E6%AE%B5%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">skippy's life</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/AIGC/">AIGC</a></div><div class="post-share"><div class="social-share" data-image="/img/wangfei.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/30/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a><a class="pagination-related" href="/2025/05/15/%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%AA%92%E4%BD%93API/" title="打破闭源限制 即时获取音乐媒体源"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">打破闭源限制 即时获取音乐媒体源</div></div><div class="info-2"><div class="info-item-1"> 已被官方修复   前言 在我开发工作中一直有调用音乐平台 API 获取音乐的需求，但是 网易云 和 QQ 音乐 的 API 现在只对企业开放申请，个人开发者已经无法使用，之前 Github 上 30k star 的项目 NCMApi 也已被网易起诉停止维护，令人唏嘘；找遍全网也没有什么好办法了，好在经过一些摸索，我也算歪打正着通过字节旗下的汽水音乐实现了获取音乐的功能。  NCMApi 停止维护  当前音乐获取的实现   实现方法讲一下我是怎么折腾实现的。  首先，主流的音乐平台，如网易云音乐、QQ 音乐，都已经不再向个人开发者提供 API 服务，这意味着你无法通过调用这些平台的 API 获取音乐文件。查找了很多第三方 API 平台的接口，也都无法正常使用 (如果你知道还有什么适用的方案，欢迎留言)。 但是在一个无人问津接近废弃的 API 平台上，可以通过 音乐名字 查找到汽水平台下这个音乐的 ID 封面 以及其他基础信息。 只是 RequestBody 中的 n 和 track_id 字段已经不再适用了，返回体也不再会返回歌曲的播放链接。不过好消息是依旧可以通过这个API...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/wangfei.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">skippy</div><div class="author-info-description">time will tell</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/skippy-404"><i class="fab fa-github"></i><span>follow me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/skippy-404" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:skippy1010177@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: ##47636e;"></i></a><a class="social-icon" href="/img/wx.jpg" target="_blank" title="WeChat"><i class="fab fa-weixin" style="color: #7bb342;"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=1352685498" target="_blank" title="网易云音乐"><i class="fa fa-music" style="color: #181b25;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%BA%E8%84%B8%E9%A3%8E%E6%A0%BC%E5%8C%96%E5%8F%AF%E8%A1%8C%E6%80%A7%E6%96%B9%E6%A1%88"><span class="toc-number">1.</span> <span class="toc-text">人脸风格化可行性方案</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%8E%B0%E6%9C%89%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7%E7%94%9F%E6%88%90"><span class="toc-number">1.1.</span> <span class="toc-text">一、现有开源工具生成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E9%80%9A%E8%BF%87-EasyControl-%E7%94%9F%E6%88%90-Ghibli-%E9%A3%8E%E6%A0%BC%E7%9A%84%E4%BA%BA%E8%84%B8%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">1、通过 EasyControl 生成 Ghibli 风格的人脸数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E9%80%9A%E8%BF%87-%E8%B1%86%E5%8C%85-%E7%94%9F%E6%88%90%E9%83%A8%E5%88%86%E9%A3%8E%E6%A0%BC%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">2、通过 豆包 生成部分风格数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E9%80%9A%E8%BF%87-HiDream-I1-%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.3.</span> <span class="toc-text">3、通过 HiDream-I1 生成数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-1X"><span class="toc-number">1.1.4.</span> <span class="toc-text">Step-1X</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81SD-3-5"><span class="toc-number">1.1.5.</span> <span class="toc-text">4、SD 3.5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Multi-Control-%E9%9D%A2%E9%83%A8%E8%A7%A3%E5%81%B6-deStyle"><span class="toc-number">1.2.</span> <span class="toc-text">二、Multi_Control 面部解偶 deStyle</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%9D%E8%AF%95%E8%BF%87%E7%9A%84%E9%83%A8%E5%88%86%E5%A4%B1%E8%B4%A5%E7%BB%84%E5%90%88"><span class="toc-number">1.2.1.</span> <span class="toc-text">尝试过的部分失败组合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E7%BB%84%E5%90%88%E4%B8%8B%E7%9A%84%E5%87%A0%E4%B8%AA%E7%96%91%E9%9A%BE%E7%82%B9"><span class="toc-number">1.2.2.</span> <span class="toc-text">当前组合下的几个疑难点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E9%A3%8E%E6%A0%BC%E9%80%82%E5%AE%9C%E5%8F%82%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">不同风格适宜参数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pixel"><span class="toc-number">2.1.</span> <span class="toc-text">pixel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3D"><span class="toc-number">2.2.</span> <span class="toc-text">3D</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#moent"><span class="toc-number">2.3.</span> <span class="toc-text">moent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FLUX-%E8%83%BD%E5%8A%9B%E6%9C%89%E9%99%90"><span class="toc-number">2.4.</span> <span class="toc-text">FLUX 能力有限</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By skippy</div><div class="footer_custom_text">喜中带忧 暗中有光 怎么度 怎么量</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://vercel.skippy.uno',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://vercel.skippy.uno',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script>window.newestComments = {
  changeContent: content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<code>.*?<\/code>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g, "") // remove html tag

    if (content.length > 150) {
      content = content.substring(0, 150) + '...'
    }
    return content
  },

  generateHtml: (array, ele) => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class="aside-list-item">'

        if (true && array[i].avatar) {
          const imgAttr = 'src'
          const lazyloadNative = ''
          result += `<a href="${array[i].url}" class="thumbnail"><img ${imgAttr}="${array[i].avatar}" alt="${array[i].nick}" ${lazyloadNative}></a>`
        }

        result += `<div class="content">
        <a class="comment" href="${array[i].url}" title="${array[i].content}">${array[i].content}</a>
        <div class="name"><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '暂无评论'
    }

    ele.innerHTML = result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh(ele)
  },

  newestCommentInit: (name, getComment) => {
    const $dom = document.querySelector('#card-newest-comments .aside-list')
    if ($dom) {
      const data = btf.saveToLocal.get(name)
      if (data) {
        newestComments.generateHtml(JSON.parse(data), $dom)
      } else {
        getComment($dom)
      }
    }
  },

  run: (name, getComment) => {
    newestComments.newestCommentInit(name, getComment)
    btf.addGlobalFn('pjaxComplete', () => newestComments.newestCommentInit(name, getComment), name)
  }
}</script><script>window.addEventListener('load', () => {
  const keyName = 'twikoo-newest-comments'
  const { changeContent, generateHtml, run } = window.newestComments

  const getComment = ele => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://vercel.skippy.uno',
        region: '',
        pageSize: 1,
        includeReply: true
      }).then(res => {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        btf.saveToLocal.set(keyName, JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray, ele)
      }).catch(err => {
        console.error(err)
        ele.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  run(keyName, getComment)
})</script><script async data-pjax src="/js/anzhiyu.js"></script><script async data-pjax src="/js/anzhiyufunction.js"></script><script async src="/js/anzhiyuOnlyOne.js"></script><div class="aplayer no-destroy" data-id="12327206939" data-server="netease" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true" ></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true 
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>